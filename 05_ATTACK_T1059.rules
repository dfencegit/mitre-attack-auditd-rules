# -----------------------------------------------------------------------
# ATTACK_T1059 - Command and Scripting Interpreter
#  * Denied file operations by non-system users
# -----------------------------------------------------------------------
-a exit,always -F arch=b64 -S creat,open,openat,open_by_handle_at,truncate,ftruncate,chmod,rename,renameat,renameat2,setxattr,lsetxattr,removexattr,lremovexattr -F exit=-EACCES -F auid>=1000 -F auid!=-1 -k ATTACK_T1059
-a exit,always -F arch=b64 -S creat,open,openat,open_by_handle_at,truncate,ftruncate,chmod,rename,renameat,renameat2,setxattr,lsetxattr,removexattr,lremovexattr -F exit=-EPERM -F auid>=1000 -F auid!=-1 -k ATTACK_T1059
-a exit,always -F arch=b32 -S creat,open,openat,open_by_handle_at,truncate,ftruncate,chmod,rename,renameat,renameat2,setxattr,lsetxattr,removexattr,lremovexattr -F exit=-EACCES -F auid>=1000 -F auid!=-1 -k ATTACK_T1059
-a exit,always -F arch=b32 -S creat,open,openat,open_by_handle_at,truncate,ftruncate,chmod,rename,renameat,renameat2,setxattr,lsetxattr,removexattr,lremovexattr -F exit=-EPERM -F auid>=1000 -F auid!=-1 -k ATTACK_T1059
-a always,exit -F arch=b64 -S execve -F comm=perl -k ATTACK_T1059
-a always,exit -F arch=b64 -S execve -F comm=ruby -k ATTACK_T1059
-a always,exit -F arch=b64 -S execve -F comm=php -k ATTACK_T1059
-a always,exit -F arch=b64 -S execve -F comm=node -k ATTACK_T1059
# ATTACK_T1059_004 - Unix Shell
-a exit,always -F arch=b64 -F exe=/bin/bash -F success=1 -S connect -k ATTACK_T1059_004
-a exit,always -F arch=b64 -F exe=/bin/csh -F success=1 -S connect -k ATTACK_T1059_004
-a exit,always -F arch=b64 -F exe=/bin/sh -F success=1 -S connect -k ATTACK_T1059_004
-a exit,always -F arch=b64 -F exe=/usr/bin/bash -F success=1 -S connect -k ATTACK_T1059_004
-a exit,always -F arch=b64 -F exe=/usr/bin/csh -F success=1 -S connect -k ATTACK_T1059_004
-a exit,always -F arch=b64 -F exe=/usr/bin/sh -F success=1 -S connect -k ATTACK_T1059_004
-a exit,always -F arch=b32 -F exe=/bin/bash -F success=1 -S connect -k ATTACK_T1059_004
-a exit,always -F arch=b32 -F exe=/bin/csh -F success=1 -S connect -k ATTACK_T1059_004
-a exit,always -F arch=b32 -F exe=/bin/sh -F success=1 -S connect -k ATTACK_T1059_004
-a exit,always -F arch=b32 -F exe=/usr/bin/bash -F success=1 -S connect -k ATTACK_T1059_004
-a exit,always -F arch=b32 -F exe=/usr/bin/csh -F success=1 -S connect -k ATTACK_T1059_004
-a exit,always -F arch=b32 -F exe=/usr/bin/sh -F success=1 -S connect -k ATTACK_T1059_004
# ATTACK_T1059_006 - Python
-a always,exit -F arch=b64 -S execve -F comm=python -k ATTACK_T1059_006
-a always,exit -F arch=b64 -S execve -F comm=python3 -k ATTACK_T1059_006
# Critical elements access failures
-a exit,always -F arch=b64 -S open -F dir=/etc -F success=0 -k ATTACK_T1059_004
-a exit,always -F arch=b64 -S open -F dir=/bin -F success=0 -k ATTACK_T1059_004
-a exit,always -F arch=b64 -S open -F dir=/sbin -F success=0 -k ATTACK_T1059_004
-a exit,always -F arch=b64 -S open -F dir=/usr/bin -F success=0 -k ATTACK_T1059_004
-a exit,always -F arch=b64 -S open -F dir=/usr/sbin -F success=0 -k ATTACK_T1059_004
-a exit,always -F arch=b64 -S open -F dir=/var -F success=0 -k ATTACK_T1059_004
-a exit,always -F arch=b64 -S open -F dir=/home -F success=0 -k ATTACK_T1059_004
-a exit,always -F arch=b64 -S open -F dir=/srv -F success=0 -k ATTACK_T1059_004
-a always,exit -F dir=/home -F uid=0 -F auid!=4294967295 -k ATTACK_T1059_004