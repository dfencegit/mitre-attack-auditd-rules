# -----------------------------------------------------------------------
# ATTACK_T1547 - Boot or Logon Autostart Execution
# -----------------------------------------------------------------------
-w /etc/sysctl.conf -p wa -k ATTACK_T1547
-w /etc/sysctl.d -p wa -k ATTACK_T1547
-w /boot/grub2/ -p wa -k ATTACK_T1547
-w /boot/efi/ -p wa -k ATTACK_T1547
-w /boot/loader/ -p wa -k ATTACK_T1547
# ATTACK_T1547_006 - Kernel Modules and Extensions
-w /sbin/insmod -p x -k ATTACK_T1547_006
-w /sbin/rmmod -p x -k ATTACK_T1547_006
-w /sbin/modprobe -p x -k ATTACK_T1547_006
-w /etc/modprobe.conf -p wa -k ATTACK_T1547_006
-w /etc/modprobe.d -p wa -k ATTACK_T1547_006
#  * Module load/unload
-a exit,always -F arch=b64 -S finit_module -S init_module -S delete_module -F auid!=-1 -k ATTACK_T1547_006
-a exit,always -F arch=b32 -S finit_module -S init_module -S delete_module -F auid!=-1 -k ATTACK_T1547_006
#  * Kexec
-a exit,always -F arch=b64 -S kexec_load -S kexec_file_load -k ATTACK_T1547_006
-a exit,always -F arch=b32 -S sys_kexec_load -k ATTACK_T1547_006